[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-12-15 17:04:04.527381",
  "module": "Hanif Traders",
  "name": "Customer Payment Receipt",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Customer Payment Receipt",
  "script": "total = 0\nfor row in doc.payment_details:\n    print(f\"Amount:\",row.amount)\n    if row.amount:\n        total=total+row.amount    \ndoc.total_amount = total\n\nif not doc.collected_by:\n    employee= frappe.db.get_value(\"Employee\",{\"user_id\":frappe.session.user},\"employee_name\")\n    print(f\"employee:\",frappe.session.user)\n    if employee:\n        doc.collected_by = employee\n    \nif doc.receipt_name == \"Manual\":\n    if not doc.receipt_number:\n        frappe.throw(\"Please enter Receipt Number manually.\")\n    doc.name = doc.receipt_number\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Submit",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-12-15 17:04:04.584528",
  "module": "Hanif Traders",
  "name": "Customer Payment Receipt Journal Entry Creation",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Customer Payment Receipt",
  "script": "for row in doc.payment_details:\n    if not row.amount:\n        continue\n\n    je = frappe.new_doc(\"Journal Entry\")\n    je.posting_date = doc.date\n    je.voucher_type = \"Journal Entry\"\n    je.cheque_no = f\"{row.bank} - {row.instrument_no}\"\n    je.cheque_date = row.instrument_date\n    \n    # Debit entry (money received from customer)\n    je.append(\"accounts\", {\n        \"account\": \"1310 - Debtors - acc\",  # adjust as per your CoA\n        \"party_type\": \"Customer\",\n        \"party\": doc.customer,\n        \"credit_in_account_currency\": row.amount,\n        \"user_remark\": doc.name\n    })\n\n    # Credit entry (to cash or bank)\n    credit_account = \"1110 - Cash - acc\"\n    je.append(\"accounts\", {\n        \"account\": credit_account,\n        \"debit_in_account_currency\": row.amount,\n        \"user_remark\": doc.name\n    })\n\n    je.insert()\n    je.save()\n    row.journal_entry = je.name",
  "script_type": "DocType Event"
 }
]